<% layout('layouts/main.layout') %>

<% block('subTitle', 'Pricing') %>

<main class="pricing-section">
  <div class="container">
    <div class="pricing-header text-center mb-5 animate__animated" data-animation="animate__fadeInDown">
      <h1 class="section-title">Token Pricing</h1>
      <p class="section-subtitle animate__animated" data-animation="animate__fadeIn animate__delay-1s">Choose the right package for your needs</p>
    </div>

    <div class="pricing-container">
      <% data.forEach(pricing => { %>
        <div class="pricing-box <%= pricing.className %> animate__animated" data-animation="<%= pricing.animation %>">
          <a href="#" class="pricing-link">
            <% if (pricing.badge.enabled) { %>
              <div class="<%= pricing.badge.className %>"><%= pricing.badge.text %></div>
            <% } %>
            <div class="pricing-header">
              <h3><%= pricing.name %></h3>
              <div class="price"><%= pricing.displayPrice %><span class="period">/<%= pricing.tokenDisplay %></span></div>
            </div>
            <div class="pricing-features">
              <ul>
                <% pricing.description.forEach(description => { %>
                  <li><i class="bi bi-check-circle"></i><%= description %></li>
                <% }) %>
              </ul>
            </div>
            <div class="pricing-footer">
              <button class="btn btn-pricing">Get Started</button>
            </div>
          </a>
        </div>
      <% }) %>
    </div>
  </div>
</main>

<div class="purchase-popup" id="purchasePopup">
  <div class="popup-content">
    <button class="popup-close" id="popupClose">&times;</button>
    <h3>How to Purchase Tokens</h3>
    <div class="popup-steps">
      <div class="step">
        <span class="step-number">1</span>
        <p>Select the token package that best suits your needs.</p>
      </div>
      <div class="step">
        <span class="step-number">2</span>
        <p>Complete the payment as per the provided amount.</p>
      </div>
      <div class="step">
        <span class="step-number">3</span>
        <p>Ensure you provide your email address on the payment page.</p>
      </div>
      <div class="step">
        <span class="step-number">4</span>
        <p>Your tokens will be delivered to your email within 24 hours.</p>
      </div>
      <div class="step">
        <span class="step-number">5</span>
        <p>If you encounter any issues, feel free to contact our support team via the contact page.</p>
      </div>
    </div>
    <a href="<%= paymentURL %>" target="_blank" rel="noopener" class="btn btn-payment">
      Got it!
    </a>
  </div>
</div>

<% block('addon-script', `
  <script nonce="${cspNonce}">
    function handlePopup() {
      const purchaseButtons = document.querySelectorAll('.btn-pricing');
      const purchasePopup = document.getElementById('purchasePopup');
      const popupClose = document.getElementById('popupClose');
      const popupContent = document.querySelector('.popup-content');

      purchaseButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          e.preventDefault();
          purchasePopup.style.display = 'flex';
          document.body.style.overflow = 'hidden';

          void purchasePopup.offsetWidth;

          purchasePopup.classList.add('show');
        });
      });

      function closePopup() {
        purchasePopup.classList.remove('show');

        setTimeout(() => {
          purchasePopup.style.display = 'none';
          document.body.style.overflow = 'auto';
        }, 300);
      }

      popupClose.addEventListener('click', closePopup);

      purchasePopup.addEventListener('click', function(e) {
        if (e.target === purchasePopup) closePopup();
      });

      popupClose.addEventListener('mouseenter', function() {
        this.style.transform = 'rotate(90deg) scale(1.1)';
      });

      popupClose.addEventListener('mouseleave', function() {
        this.style.transform = 'rotate(0) scale(1)';
      });
    }

    document.addEventListener('DOMContentLoaded', handlePopup);
  </script>
`) %>
